---
// Unified About and Certification Section
// ------------
// Description: A unified section combining company information and certifications with shared background

// Components
// - Layout
import Section from '../../ui/Section.astro'
import Row from '../../ui/Row.astro'
import Col from '../../ui/Col.astro'
// - UI
import Card from '../../ui/cards/BasicCard.astro'
import { Image } from 'astro:assets'

// Content - Certification logos (corrected paths)
import ivs from '../../../assets/ivsc-logo.png'
import rics from '../../../assets/Rics-Logo.png'
import ifrs from '../../../assets/ifrs-logo.png'
import sisv from '../../../assets/sisv-logo.png'

const certificationLogos = [
	{
		image: ivs,
		alt: 'IVS Standards',
		title: 'International Valuation Standards (IVS)',
		subtitle: 'IVS covers the valuation of a range of assets -- financial instruments, fixed assets, intangible assets & business interests.'
	},
	{
		image: rics,
		alt: 'RICS Compliant',
		title: 'Royal Institution Of Chartered Surveyors (RICS)',
		subtitle: 'RICS provides valuation standards, protects consumers with strict codes of practice and advises governments and business. RICS provides expertise in matters involving fixed assets, including but not limited to land and real property.'
	},
	{
		image: ifrs,
		alt: 'IFRS Reporting',
		title: 'International Financial Reporting Standards (IFRS)',
		subtitle: 'IFRS is a common global language for business affairs so that company accounts are understandable and comparable across international boundaries.'
	},
	{
		image: sisv,
		alt: 'SISV Member',
		title: 'Singapore Institute Of Surveyors And Valuers (SISV)',
		subtitle: 'The Institute was established in 1982 when the Singapore Institute of surveyors and the Singapore Institute of Valuers merged. The Valuers give advice on the values of interests in property upon which all real estate activities are based on.'
	}
]

// Props
type Props = {
	bg?: string;
	classes?: string
}
const { bg, classes } = Astro.props;
---

	<!-- Combined About Us & Experience Section -->
	<Section id="about-us" classes=" bg-white">
		<!-- About Us Introduction
		<Row classes="mb-16">
			<Col span="12" align="center">
				<h2 class="text-4xl lg:text-5xl font-bold text-neutral-700 mb-6 leading-tight">
					About Us
				</h2>
				<p class="text-lg text-neutral-700 leading-relaxed max-w-8xl mt-8 mx-auto">
					Twin Pillars is a premier valuation firm committed to providing a comprehensive suite of appraisal services tailored to your needs. We specialize in delivering precise, defensible valuations across all major asset classes, simplifying complex appraisal processes and empowering your strategic decisions.
				</p>
			</Col>
		</Row> -->

		<!-- Experience Content -->
		<Row>
			<Col span="8" classes="">
				<div class="text-center lg:text-left">
					<h3 class="text-4xl lg:text-5xl font-bold text-neutral-800 leading-tight">
						About Us
					</h3>
					
					<div class="text-lg text-neutral-800 leading-relaxed">
						<p>
							Twin Pillars is a premier valuation firm committed to providing a comprehensive suite of appraisal services tailored to your needs. We specialize in delivering precise, defensible valuations across all major asset classes, simplifying complex appraisal processes and empowering your strategic decisions.
						</p>
					</div>
					<h3 class="text-4xl lg:text-5xl font-bold text-neutral-800 mt-10 leading-tight">
						Built on 
						<span class="bg-gradient-to-r from-primary-400 to-primary-500 bg-clip-text text-transparent">
							Unparalleled Experience
						</span>
					</h3>
					
					<div class="space-y-6 text-lg mt-8 text-neutral-800 leading-relaxed">
						<p>
							At Twin Pillars, our foundation is built on unparalleled experience. Our esteemed founder, 
							Mr. Milton Tan, spearheads our 
							machinery and equipment valuation practice with over three decades of experience, contributing to a 
							staggering <span class="font-semibold text-neutral-800">USD 30 billion</span> in volume. This profound market understanding and exceptional capability 
							underscore our commitment to excellence.
						</p>
						<p>
							We deliver sound valuation services to a diverse and expansive clientele, ranging from private entities 
							to publicly listed companies, financial institutions and various government agencies throughout Asia. 
							With our head office strategically located in Singapore and a network of affiliated companies across Asia, 
							we ensure comprehensive regional coverage and localized insights.
						</p>
					</div>
				</div>
			</Col>
			<Col span="4" classes="mt-16">
				<div class="space-y-8">
					<!-- Years of Experience Card -->
					<div class="group stat-card bg-white dark:bg-neutral-800 rounded-2xl p-8 text-center shadow-lg border border-neutral-200 dark:border-neutral-700 hover:shadow-xl transition-all duration-300 hover:-translate-y-1 opacity-0 translate-y-8">
						<div class="text-4xl font-bold bg-gradient-to-r from-primary-400 to-primary-500 bg-clip-text text-transparent mb-2">
							<span class="counter" data-target="30">30</span>+
						</div>
						<div class="text-sm font-medium font-semibold text-neutral-800 dark:text-neutral-400">Years of Experience</div>
					</div>
					
					<!-- USD Valuation Volume Card -->
					<div class="group stat-card bg-white dark:bg-neutral-800 rounded-2xl p-8 text-center shadow-lg border border-neutral-200 dark:border-neutral-700 hover:shadow-xl transition-all duration-300 hover:-translate-y-1 opacity-0 translate-y-8">
						<div class="text-4xl font-bold bg-gradient-to-r from-primary-400 to-primary-500 bg-clip-text text-transparent mb-2">
							$<span class="counter" data-target="30">30</span>B
						</div>
						<div class="text-sm font-medium font-semibold text-neutral-800 dark:text-neutral-400">USD Valuation Volume</div>
					</div>
					
					<!-- Countries Covered Card -->
					<div class="group stat-card bg-white dark:bg-neutral-800 rounded-2xl p-8 text-center shadow-lg border border-neutral-200 dark:border-neutral-700 hover:shadow-xl transition-all duration-300 hover:-translate-y-1 opacity-0 translate-y-8">
						<div class="text-4xl font-bold bg-gradient-to-r from-primary-400 to-primary-500 bg-clip-text text-transparent mb-2">
							<span class="counter" data-target="36">36</span>
						</div>
						<div class="text-sm font-medium font-semibold text-neutral-800 dark:text-neutral-400">Countries Covered across Asia Pacific</div>
					</div>
				</div>
			</Col>

		</Row>
	</Section>

	<!-- Excellence in Valuation Section -->
	<Section classes="py-20 bg-neutral-800">
		<Row>
			<Col span="12" align="center" classes="mb-16">
				<h2 class="text-4xl lg:text-5xl font-bold text-white mb-6 leading-tight">
					<span class="bg-gradient-to-r from-primary-400 to-primary-500 bg-clip-text text-transparent">Excellence</span>
					<span class="text-white"> in Valuation</span>
				</h2>
				<p class="text-lg text-neutral-50 leading-relaxed max-w-8xl mx-auto">
					At Twin Pillars, quality and adherence to global standards are paramount. Every report we produce is meticulously prepared, strictly 
					following the rigorous benchmarks set by the Royal Institution of Chartered Surveyors (RICS) and International Valuation Standards 
					(IVS). This unwavering commitment to best practices and superior service has cemented our reputation as trusted valuers in the 
					valuation industry. We don't just provide valuations; we provide trusted insights backed by the highest global standards, ensuring your 
					valuations are reliable, globally recognized, and defensible.
				</p>
			</Col>
		</Row>
		
		<!-- Certification Cards -->
		<Row >
			{
				certificationLogos.map((cert) => (
					<Col span="3">
						<div class="group certification-card bg-gradient-to-br from-gray-100 to-gray-200 rounded-2xl p-8 text-center shadow-lg border border-neutral-100 hover:border-primary-400 h-full hover:shadow-xl transition-all duration-300 hover:-translate-y-2">
							<div class="cert-logo-wrapper mb-6">
								<div class="h-16 flex items-center justify-center mb-4">
									<Image 
										src={cert.image} 
										alt={cert.alt} 
										class="max-h-16 w-auto object-contain transition-transform duration-300 group-hover:scale-110"
									/>
								</div>
							</div>
							<h3 class="text-lg font-semibold text-neutral-800 mb-2">
								{cert.title}
							</h3>
							<p class="text-sm text-neutral-700 leading-relaxed">
								{cert.subtitle}
							</p>
						</div>
					</Col>
				))
			}
		</Row>

		<!-- Trust Badge -->
		<Row classes="mt-12 lg:mt-20">
			<Col span="12" align="center">
				<div class="inline-flex items-center gap-3 bg-gradient-to-r from-primary-400 to-primary-300 rounded-full px-6 py-6 lg:px-12 lg:py-6 border border-neutral-400">
					<svg class="w-8 h-8 text-neutral-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path class="stroke-neutral-800" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
					</svg>
					<span class="text-sm lg:text-lg text-neutral-800 font-semibold">
						Trusted insights backed by the highest global standards
					</span>
				</div>
			</Col>
		</Row>
	</Section>
</div>

<style>
	/* Enhanced styling for better visual appeal */
	.stat-card {
		position: relative;
		overflow: hidden;
	}
	
	.certification-card {
		position: relative;
		overflow: hidden;
	}
	
	.cert-logo-wrapper {
		transition: transform 0.3s ease;
	}
	
	/* Enhanced logo styling */
	
	.certification-card:hover img {
		filter: grayscale(0) opacity(1);
	}
	
	/* Dark background specific styling */
	.bg-gradient-to-br.from-neutral-800.to-neutral-900 .certification-card {
		background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.9));
		backdrop-filter: blur(10px);
	}
	
	.bg-gradient-to-br.from-neutral-800.to-neutral-900 .certification-card:hover {
		background: linear-gradient(135deg, rgba(255, 255, 255, 1), rgba(248, 250, 252, 0.95));
		border-color: #ebc534;
		box-shadow: 0 25px 50px -12px rgba(235, 197, 52, 0.25);
	}
	
	/* Smooth gradient animations */
	.bg-gradient-to-r.from-primary-400.to-primary-600 {
		background-size: 200% 200%;
		animation: gradientShift 3s ease infinite;
	}
	
	@keyframes gradientShift {
		0%, 100% {
			background-position: 0% 50%;
		}
		50% {
			background-position: 100% 50%;
		}
	}
	
	/* Responsive adjustments */
	@media (max-width: 768px) {
		.stat-card {
			margin-bottom: 1.5rem;
		}
		
		.certification-card {
			margin-bottom: 2rem;
		}
	}

.stat-card {
		position: relative;
		overflow: hidden;
		transition: all 0.6s ease;
	}
	
	/* Animation states */
	.stat-card.animate-in {
		opacity: 1 !important;
		transform: translateY(0) !important;
	}
	
	/* Counter animation styles */
	.counter {
		display: inline-block;
		transition: all 0.3s ease;
	}
	
	/* Rest of your existing styles... */
</style>

<script>
	// Counter Animation Function with proper TypeScript types
	function animateCounter(element: HTMLElement, target: number, duration: number = 500): void {
		const start = 0;
		const increment = target / (duration / 16); // 60fps
		let current = start;
		
		const timer = setInterval(() => {
			current += increment;
			if (current >= target) {
				current = target;
				clearInterval(timer);
			}
			element.textContent = Math.floor(current).toString();
		}, 16);
	}

	// Enhanced Intersection Observer
	const observerOptions: IntersectionObserverInit = {
		threshold: 0.3,
		rootMargin: '0px 0px -100px 0px'
	};

	const observer = new IntersectionObserver((entries: IntersectionObserverEntry[]) => {
		entries.forEach(entry => {
			if (entry.isIntersecting) {
				const card = entry.target as HTMLElement;
				const counter = card.querySelector('.counter') as HTMLElement;
				
				if (counter) {
					const targetAttribute = counter.getAttribute('data-target');
					
					// Check if data-target exists and is not null
					if (targetAttribute) {
						const target = parseInt(targetAttribute, 10);
						
						// Validate that target is a valid number
						if (!isNaN(target)) {
							// Animate card appearance
							card.classList.add('animate-in');
							
							// Reset counter to 0 and start animation
							counter.textContent = '0';
							
							// Start counting animation with delay
							setTimeout(() => {
								animateCounter(counter, target, 2500);
							}, 300);
						}
					}
				}
				
				// Unobserve after animation starts
				observer.unobserve(card);
			}
		});
	}, observerOptions);

	// Start observing when DOM is loaded
	document.addEventListener('DOMContentLoaded', () => {
		const statCards = document.querySelectorAll('.stat-card') as NodeListOf<HTMLElement>;
		statCards.forEach((card, index) => {
			// Add staggered delay for multiple cards
			setTimeout(() => {
				observer.observe(card);
			}, index * 100);
		});
	});
</script>